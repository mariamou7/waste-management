## Ο Αλγόριθμος

Αρχικά, στον κώδικά μας βρίσκονται οι ενσωματώσεις των **βιβλιοθηκών**, οι **αρχικοποιήσεις** των μεταβλητών και οι **ονοματοδοσίες** των pins του Arduino.

Στη μέθοδο ***setup()*** ορίζουμε αν το κάθε pin του Arduino χρησιμοποιείται ως **είσοδος ή ως έξοδος** και γίνεται και η διαδικασία σύνδεσης με το **Wifi**.

Το βασικό τμήμα του αλγορίθμου μας βρίσκεται στη μέθοδο ***loop()***.

Εκεί, αρχικά θέτουμε το ***trig pin*** του **ultrasonic** στο *LOW*, ώστε να το "**καθαρίσουμε**" από προηγούμενες μετρήσεις.
Στη συνέχεια, το θέτουμε στο ***HIGH*** για 10 μs, ώστε να παράξει τη **συχνότητα** που χρειάζεται.

Μετά, θέτουμε το ***echo pin*** του ultrasonic στο ***HIGH***, ώστε να **λάβει τη συχνότητα** αυτή.
Τότε, **υπολογίζουμε την απόσταση** που έχει διανύσει ο ήχος με τον τύπο *απόσταση = (χρόνος * ταχύτητα του ήχου) / 2*.
Επιπλέον, βρήκαμε πως ο ήχος ταξιδεύει με περίπου 340 μέτρα ανά δευτερόλεπτο.
Το "2" βρίσκεται στον τύπο επειδή ο ήχος πρέπει να ταξιδεύει εμπρός και πίσω.

Έπειτα, επαναλαμβάνουμε αυτή τη διαδικασία και για τον **δεύτερο ultrasonic**.

Στη συνέχεια, τοποθετήσαμε μια δομή ***switch***, η οποία έχει δύο καταστάσεις, την ***OPEN*** και την ***CLOSE***.
Στην ***CLOSE*** ο **κινητήρας είναι στις 0 μοίρες**, ώστε ο κάδος να είναι κλειστός.
Αν η **απόσταση του χρήστη** στον κάδο είναι **μικρότερη των 50 εκατοστών**, τότε ο κάδος ανοίγει και πηγαίνει στην κατάσταση ***OPEN***.

Αντίθετα, στην κατάσταση ***OPEN*** ο **κινητήρας είναι στις 120 μοίρες**, ώστε ο κάδος να είναι ανοιχτός.
Επίσης, αν η απόσταση του **εσωτερικού ultrasonic** είναι μικρότερη ή ίση με 13 εκατοστά, το ***currentState*** γίνεται ίσο με 1, αλλιώς παίρνει την τιμή 0.
Αν το currentState και το ***previousState*** έχουν διαφορετικές τιμές και αν το currentState ισούται με 1, τότε ο μετρητής που μετράει **πόσες σακούλες** έχει τοποθετήσει ο χρήστης **αυξάνεται κατά 1**.

Αν η **απόσταση του χρήστη** στον κάδο είναι **μεγαλύτερη των 50 εκατοστών**, τότε ο κάδος ανοίγει και πηγαίνει στην κατάσταση ***CLOSE***.

Τέλος, θέλουμε να γνωρίζουμε την **τάση φόρτισης** της **μπαταρίας**, για να ξέρουμε πόσο **φορτισμένη** είναι η συσκευή μας. Γνωρίζουμε πως, η αναλογική είσοδος δέχεται από 0-5V χρησιμοποιώντας τις τιμές από 0-1023 αντίστοιχα. Για τον λόγο αυτόν χρησιμοποιήθηκε ως μετατροπέας AD (αναλογικού σήματος σε ψηφιακό) - ο δικής μας κατασκευής - διαιρέτης τάσης, ο οποίος εφαρμόζεται στην μπαταρία των 12V του project και σε πλήρη φόρτιση στέλνει στην αναλογική είσοδο 5V.

Έτσι, για τον υπολογισμό της τάσης φόρτισης της μπαταρίας χρησιμοποιούμε τον τύπο *(τιμή αναλογικής μέτρησης * 12)/1023* προκειμένου να μετατρέψουμε αντίστροφα την τιμή της αναλογικής μέτρησης (0-1023) σε volt (0-12).
